<form method="post" id="{{key}}">
	<input
		class="name"
		placeholder="e.g. background"
		type="hidden"
		value="{{key}}"
	/>
	<input
		class="value"
		name="locals.{{key}}"
		placeholder="e.g. #FFFFFF"
		type="hidden"
		value="{{value}}"
	/>
	<div class="color-picker-{{key}}" style="cursor: pointer;display: flex;align-items: center;">
		<span style="margin:5px 16px;flex-grow: 1">{{label}}</span>
		<span style="outline: 1px solid rgba(0,0,0,0.2);outline-offset:-1px;margin:0 16px;width:1.25rem;height:1.25rem;background:{{value}};display: block;"></span>
	</div>
	<div class="clear"></div>
</form>

<link rel="stylesheet" type="text/css" href="/css/pickr/themes/monolith.min.css">
<script type="text/javascript" src="/scripts/pickr/es5.min.js"></script>

<style type="text/css">
	.pickr {
		z-index: auto;
	}
	.pcr-app .pcr-selection .pcr-picker {
		z-index: 1;
	}
</style>
<script>
	// Simple example, see optional options for more configuration.
	const pickr{{key}} = Pickr.create({
    el: '.color-picker-{{key}}',
    theme: 'monolith', // or 'monolith', or 'nano'
    default: '{{value}}',
    useAsButton: true,
    position: 'top-start',
    components: {

        // Main components
        preview: true,
        opacity: true,
        hue: true,

        // Input / output Options
        interaction: {
            // hex: true,
            // rgba: true,
            // hsla: true,
            // hsva: true,
            // cmyk: true,
            input: true,
            // clear: true,
            save: true
        }
    }
});

	pickr{{key}}.on('init', instance => {
    console.log('init', instance);
}).on('hide', instance => {
    console.log('hide', instance);
}).on('show', (color, instance) => {
    console.log('show', color, instance);
}).on('save', (color, instance) => {
		document.querySelector('input[name="locals.{{key}}"]').value = color.toHEXA().toString();
    document.querySelector('form[id="{{key}}"]').submit();
}).on('clear', instance => {
    console.log('clear', instance);
}).on('change', (color, instance) => {
    console.log('change', color, instance);
}).on('changestop', instance => {
    console.log('changestop', instance);
}).on('cancel', instance => {
    console.log('cancel', instance);
}).on('swatchselect', (color, instance) => {
    console.log('swatchselect', color, instance);
});
</script>
